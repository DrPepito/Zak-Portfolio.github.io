// HEADER RETRACTABLE


let lastScroll = 0;
const header = document.querySelector('.site-header');
const logo = document.querySelector('.logo-container img');

window.addEventListener('scroll', () => {
  const currentScroll = window.pageYOffset;

  if (currentScroll > lastScroll) {
    // Scroll vers le bas => rétracter
    header.style.height = '60px'; // hauteur réduite
    logo.style.width = '40px'; // logo plus petit
    logo.style.top = '10px';    // déplacer vers le coin
  } else {
    // Scroll vers le haut => ré-expand
    header.style.height = '100px'; // hauteur normale
    logo.style.width = '60px'; // logo normal
    logo.style.top = '20px';    // position normale
  }
  lastScroll = currentScroll;
});





// FADE-IN DES PROJETS
const faders = document.querySelectorAll('.fade-in');
const appearOptions = { threshold: 0.2, rootMargin: "0px 0px -50px 0px" };
const appearOnScroll = new IntersectionObserver((entries, observer) => {
  entries.forEach(entry => {
    if (!entry.isIntersecting) return;
    entry.target.classList.add('visible');
    observer.unobserve(entry.target);
  });
}, appearOptions);
faders.forEach(fader => appearOnScroll.observe(fader));

// VALIDATION FORMULAIRE CONTACT
const form = document.querySelector('form[name="contact"]');
if(form){
  form.addEventListener('submit', e => {
    const email = form.querySelector('input[type="email"]').value;
    const nom = form.querySelector('input[name="nom"]').value;
    const msg = form.querySelector('textarea[name="message"]').value;

    if(!email.includes('@') || !nom || !msg){
      alert("Merci de remplir correctement tous les champs.");
      e.preventDefault();
    } else {
      alert("Message envoyé !");
    }
  });
}

// CLIQUER SUR IMAGE POUR OUVRIR PROJET
document.querySelectorAll('.projet-item img').forEach(img => {
  img.addEventListener('click', () => {
    const link = img.parentElement.querySelector('.projet-text a');
    if(link) link.click();
  });
});


// Création de l'overlay
const overlay = document.createElement('div');
overlay.classList.add('lightbox-overlay');
document.body.appendChild(overlay);

const overlayImg = document.createElement('img');
overlay.appendChild(overlayImg);

// Ouvrir l'image au clic
document.querySelectorAll('.lightbox-link').forEach(link => {
  link.addEventListener('click', function(e) {
    e.preventDefault();
    overlayImg.src = this.href;
    overlay.classList.add('active');
  });
});

// Fermer au clic sur overlay
overlay.addEventListener('click', () => {
  overlay.classList.remove('active');
});


document.querySelector('form[name="contact"]').addEventListener('submit', function(e) {
  e.preventDefault(); // empêche l'envoi classique

  const nom = document.getElementById('nom').value;
  const email = document.getElementById('email').value;
  const message = document.getElementById('message').value;

  const gmailLink = `https://mail.google.com/mail/?view=cm&fs=1&to=zakaria.boschetti@gmail.com&su=Contact depuis le portfolio&body=Nom:%20${nom}%0AEmail:%20${email}%0AMessage:%20${message}`;
  
  window.open(gmailLink, '_blank');

  // afficher la notif
  const notif = document.getElementById('notif');
  notif.classList.add('show');

  // cacher la notif après 3 secondes
  setTimeout(() => {
    notif.classList.remove('show');
  }, 3000);

  // réinitialiser le formulaire
  this.reset();
});
